<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>后台管理 - 云服务器折扣信息聚合网</title>
    <meta name="description" content="云服务器折扣信息聚合网站后台管理系统，用于添加和管理各云服务商的折扣信息">
    <link rel="stylesheet" href="css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <header class="header">
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="/">云服务器折扣网</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item"><a class="nav-link" href="/">首页</a></li>
                        <li class="nav-item"><a class="nav-link" href="/discounts">折扣信息</a></li>
                        <li class="nav-item"><a class="nav-link" href="/about">关于我们</a></li>
                    </ul>
                    <ul class="navbar-nav">
                        <li class="nav-item"><a class="nav-link active" href="/admin">后台管理</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <main class="admin-container">
        <div class="admin-header text-center">
            <h1>后台管理系统</h1>
            <p class="lead">管理云服务器折扣信息</p>
        </div>

        <div class="form-section">
            <h3>添加新的折扣信息</h3>
            <form id="discountForm">
                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="provider" class="form-label">云服务商</label>
                            <select class="form-select" id="provider" required>
                                <option value="">选择云服务商</option>
                                <option value="aliyun">阿里云</option>
                                <option value="tencent">腾讯云</option>
                                <option value="huawei">华为云</option>
                                <option value="ucloud">UCloud</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="category" class="form-label">产品类别</label>
                            <select class="form-select" id="category" required>
                                <option value="云服务器">云服务器</option>
                                <option value="轻量应用服务器">轻量应用服务器</option>
                                <option value="弹性云服务器">弹性云服务器</option>
                                <option value="云主机">云主机</option>
                                <option value="数据库">数据库</option>
                                <option value="存储">存储</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="mb-3">
                    <label for="title" class="form-label">折扣标题</label>
                    <input type="text" class="form-control" id="title" placeholder="输入折扣标题" required>
                </div>
                
                <div class="mb-3">
                    <label for="description" class="form-label">折扣描述</label>
                    <textarea class="form-control" id="description" rows="3" placeholder="输入折扣详细描述" required></textarea>
                </div>
                
                <div class="row">
                    <div class="col-md-4">
                        <div class="mb-3">
                            <label for="originalPrice" class="form-label">原价</label>
                            <input type="text" class="form-control" id="originalPrice" placeholder="例如: 299元" required>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="mb-3">
                            <label for="discountPrice" class="form-label">折扣价</label>
                            <input type="text" class="form-control" id="discountPrice" placeholder="例如: 99元" required>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="mb-3">
                            <label for="discount" class="form-label">折扣</label>
                            <input type="text" class="form-control" id="discount" placeholder="例如: 3.3折" required>
                        </div>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="link" class="form-label">购买链接</label>
                            <input type="url" class="form-control" id="link" placeholder="https://example.com" required>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="validUntil" class="form-label">有效期至</label>
                            <input type="date" class="form-control" id="validUntil" required>
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="btn btn-primary">添加折扣信息</button>
            </form>
        </div>

        <div class="discount-list">
            <h3>已有的折扣信息</h3>
            <div class="row" id="existingDiscounts">
                <!-- 现有折扣信息将通过JavaScript加载 -->
            </div>
        </div>
    </main>

    <footer class="footer bg-dark text-white py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <h5>云服务器折扣网</h5>
                    <p>聚合各大云服务商的优惠信息，帮您选择最优惠的云服务器方案</p>
                </div>
                <div class="col-md-4">
                    <h5>快速链接</h5>
                    <ul class="list-unstyled">
                        <li><a href="/" class="text-white">首页</a></li>
                        <li><a href="/discounts" class="text-white">折扣信息</a></li>
                        <li><a href="/about" class="text-white">关于我们</a></li>
                        <li><a href="/admin" class="text-white">后台管理</a></li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <h5>联系方式</h5>
                    <p>邮箱: info@cloud-discount.com</p>
                    <p>微信: cloud-discount</p>
                </div>
            </div>
            <hr>
            <div class="text-center">
                <p>&copy; 2023 云服务器折扣信息聚合网. 保留所有权利.</p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 加载现有折扣信息
            loadExistingDiscounts();
            
            // 添加表单提交事件监听器
            const form = document.getElementById('discountForm');
            if (form) {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    addNewDiscount();
                });
            }
        });

        // 加载现有折扣信息
        function loadExistingDiscounts() {
            const container = document.getElementById('existingDiscounts');
            if (!container) return;
            
            container.innerHTML = '';
            
            // 使用模拟数据展示现有折扣
            discountData.forEach(discount => {
                const discountItem = createDiscountItem(discount);
                container.appendChild(discountItem);
            });
        }

        // 创建折扣项元素
        function createDiscountItem(discount) {
            const item = document.createElement('div');
            item.className = 'col-12';
            item.innerHTML = `
                <div class="discount-item">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <h5>${discount.title}</h5>
                            <p class="mb-1"><strong>服务商:</strong> ${discount.provider}</p>
                            <p class="mb-1"><strong>价格:</strong> <span class="text-danger">¥${discount.discountPrice}</span> 
                               <span class="text-muted">原价: ¥${discount.originalPrice}</span> (${discount.discount})
                            </p>
                            <p class="mb-0"><strong>有效期:</strong> ${discount.validUntil}</p>
                        </div>
                        <div class="col-md-4 text-md-end discount-actions">
                            <button class="btn btn-sm btn-warning me-2" onclick="editDiscount(${discount.id})">编辑</button>
                            <button class="btn btn-sm btn-danger" onclick="deleteDiscount(${discount.id})">删除</button>
                        </div>
                    </div>
                </div>
            `;
            
            return item;
        }

        // 添加新折扣
        function addNewDiscount() {
            // 获取表单数据
            const providerValue = document.getElementById('provider').value;
            const providerMap = {
                'aliyun': '阿里云',
                'tencent': '腾讯云', 
                'huawei': '华为云',
                'ucloud': 'UCloud'
            };
            
            const newDiscount = {
                id: discountData.length + 1,
                provider: providerMap[providerValue],
                providerKey: providerValue,
                title: document.getElementById('title').value,
                description: document.getElementById('description').value,
                originalPrice: document.getElementById('originalPrice').value,
                discountPrice: document.getElementById('discountPrice').value,
                discount: document.getElementById('discount').value,
                link: document.getElementById('link').value,
                validUntil: document.getElementById('validUntil').value,
                category: document.getElementById('category').value
            };
            
            // 添加到数据数组
            discountData.push(newDiscount);
            
            // 更新界面
            loadExistingDiscounts();
            
            // 重置表单
            document.getElementById('discountForm').reset();
            
            alert('折扣信息添加成功！');
        }

        // 编辑折扣
        function editDiscount(id) {
            alert('编辑功能在实际应用中会打开编辑表单，这里仅作演示');
        }

        // 删除折扣
        function deleteDiscount(id) {
            if (confirm('确定要删除这个折扣信息吗？')) {
                const index = discountData.findIndex(item => item.id === id);
                if (index !== -1) {
                    discountData.splice(index, 1);
                    loadExistingDiscounts();
                    alert('折扣信息已删除！');
                }
            }
        }
    </script>
</body>
</html>